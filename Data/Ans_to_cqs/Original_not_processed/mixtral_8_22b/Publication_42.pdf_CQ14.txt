Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.

To ﬁnd the best CNN architecture for species classiﬁcation, different hyperparameters
were adjusted as described in Section 2.2.3. A total of 64 architectures were trained using a
dropout probability of 0.3 after the second to last hidden layer. The average F1-score for all
classes was used as a measure for a given architecture’s performance.

The ﬁve best architectures had high F1-scores, which only varied by 0.02, but had a
varying number of learnable parameters (Table 2). Compared to SGD, Adam turned out to
be the superior optimizer for training of all models. In the end, the architecture that had
a rating among the three highest F1-score but the lowest amount of learnable parameters
(2,197,578) was chosen. The reason for this is that an architecture with many parameters
and few training data would increase the risk of overﬁtting the neural network.

2.2.3. Moth Species Classiﬁcation

In the ﬁeld of deep learning, speciﬁc architectures of CNNs have provided particularly
positive results in many areas of computer vision [31]. CNNs use both pixel intensity
values and spatial information about objects in the image. It was a challenging task to ﬁnd
a suitable CNN architecture for classiﬁcation of moth species. Based on an investigation
of several CNN architectures [32,33], a customized network was designed inspired by the
work in [34]. Hyperparameters of the architecture were explored to ﬁnd the optimal
network architecture to classify moth species. The model was designed to be light and fast
for the purpose of being able to be executed on the embedded Raspberry Pi computer used
in the light trap.

The chosen model shown in Figure 5 had an F1-score of 92.75%, which indicated that
the trained CNN was very accurate in its predictions. This ﬁnal architecture was chosen
because it achieved average precision, recall, and an F1-score of 93%, which indicated a
suitable model classiﬁcation.

Sensors 2021, 21, 343

10 of 18

Table 2. Ranking of the CNN architectures with highest and lowest F1 classiﬁcation scores. Rank 1 to
32 were trained using the Adam optimizer. Rank 33 to 64 were trained using the SGD optimizer. The
hyperparameters column shows values of {kernel size layer 1, kernel size last layer, convolutional
depth layer 1, convolutional depth last layer, fully connected size}.

Rating

Hyperparameters

Learnable
Parameters

F1/-Score

1.
2.
3.
4.
5.
...
31.
32.

33.
34.
...
62.
63.
64.

3, 3, 32, 128, 512
5, 1, 32, 128, 512
5, 3, 32, 64, 512
3, 3, 32, 64, 512
5, 3, 32, 128, 512

5, 1, 64, 64, 512
5, 3, 32, 32, 512

5, 3, 64, 128, 512
5, 3, 32, 128, 512

5, 3, 64, 128, 512
5, 3, 32, 128, 512

5, 1, 64, 64, 512
3, 3, 64, 64, 256
3, 3, 64, 64, 512

4,330,122
4,266,122
2,197,578
2,196,042
4,331,658

2,185,674
2,164,810

4,352,522
4,331,658

2,185,674
1,163,978
2,215,370

0.942
0.929
0.928
0.923
0.922

0.871
0.871

0.853
0.853

0.749
0.737
0.682

The confusion matrix (Figure 7) was based upon the validation of the chosen model.
The confusion matrix has a diagonal trend, which indicates that the model matched
the validation set well. The model had a recall of 93%, indicating that only 7% of the
moth species in the validation set were missed. A similar precision of 93% was obtained,
indicating that only 7% were wrongly classiﬁed.

Figure 7. Confusion matrix for the validation of the best model. The numbers corresponds to the
species numbers in Table 1.

Question: %INSTRUCTIONS:
Use the provided pieces of context to answer the query in less than 400 words. If you don't know the answer, just say that you don't know, don't try to make up an answer.

%Query
Query: "How are the hyperparameters of the model optimized (e.g., grid search, random search)?"

Provide your answer as follows:

Answer:::
Answer: (provide your answer to query in less than 400 words)

Answer:::

Helpful Answer:
According to the provided context, the hyperparameters of the model were optimized through exploration to find the optimal network architecture for classifying moth species. However, the specific method used for optimization, such as grid search or random search, is not explicitly mentioned. Therefore, I cannot provide a definitive answer regarding the exact method used for hyperparameter optimization.