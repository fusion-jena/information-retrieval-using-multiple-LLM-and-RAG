The training of the MLP model is designed to complete when a plateau is reached in the validation loss. This is achieved through the use of a scheduler that adjusts the learning rate during training. The MLP model's training involves the use of the Adam optimizer, and the learning rate is set to 0.00001 and 0.0001, with batch sizes of 8, 16, 32, and 64 tested. Weight decay is varied between 0.0001 and 0.001, with a dropout of 0.1.

For the diffusion model, the training is completed using a dataset consisting of trajectories of a fixed length. The length of these trajectories is determined by plotting the histogram of the original trajectory lengths and extracting statistics, including the minimum, maximum, average, and median lengths. The analysis revealed that the majority of trajectories have a length of 13, and consequently, a standard trajectory length of 13 is established for the model.

After segmenting the trajectories into fixed lengths of 13, segments shorter than 6 detections are discarded, and segments with 6 to 12 detections have their data points replicated until they reach the required length of 13. Finally, each coordinate of the fish detection is scaled within the range of [1,1].

The training and validation of the models employ a stratified train-test split, which is particularly beneficial for imbalanced datasets. This procedure maintains the proportion, in this case, 80%-20%, for each class of the original dataset, ensuring that all classes participate in both the training and validation phases of the model. However, this stratified train-test split is not applied to the dataset composed of trajectories of length 13 but rather to the original trajectories of variable length. This is done to ensure that each trajectory belongs exclusively to either the train or validation splits, and as a consequence, in terms of fixed-length trajectories, each with a length of 13, 13,489 samples are obtained in training and 3448 samples in validation.

Therefore, the training of the MLP model is designed to complete when a plateau is reached in the validation loss, while the diffusion model's training is completed using a dataset consisting of trajectories of a fixed length, determined by analyzing the statistics of the original trajectory lengths.