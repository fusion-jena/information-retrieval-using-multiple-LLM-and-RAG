The hyperparameters are optimized using a combination of batch search and random search.